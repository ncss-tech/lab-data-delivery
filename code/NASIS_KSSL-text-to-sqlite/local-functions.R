## TODO: merge into a library of functions
